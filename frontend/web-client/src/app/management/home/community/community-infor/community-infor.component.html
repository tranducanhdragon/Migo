<div [@routerTransition]>
    <section class="content-header">
        <div class="container-fluid">
            <div class="row">
                <div class="col-6">
                    <h4>{{ "Thông tin dịch vụ"}}</h4>
                </div>
                <div class="col-6 text-right">
                    <a class="btn"
                        [routerLink]="['../community-menu']">
                        <i class="fas fa-arrow-alt-circle-left"></i>
                        {{"Trở về"}}
                    </a>
                    &nbsp;
                </div>
            </div>
        </div>
    </section>
    <!-- Create Community -->
    <section>
        <div class="row">
            <div class="col-6 ml-4">
                <button class="btn bg-light m-2" (click)="open(mymodal)">Thêm mới dịch vụ</button>
                <button class="btn bg-light m-2" (click)="open(notiModal)">
                    Số lượt đặt
                    <p-badge
                        [value]="bookingNotis.length.toString()"
                        severity="info">
                    </p-badge>
                </button>
            </div>
        </div>
    </section>
    <!-- popup create -->
    <ng-template #mymodal let-modal>
        <div class="modal-header">
        <h4 class="modal-title">Thông tin dịch vụ</h4>
        <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
            <span aria-hidden="true">&times;</span>
        </button>
        </div>
        <div class="modal-body">
            <div class="row">
                <div class="col-12">
                    <div class="form-group">
                        <label>Ảnh đại diện</label>
                        <span class="text-danger">*</span>
                        <div class="custom-file">
                            <input 
                                type="file" 
                                class="custom-file-input"
                                (change)="uploadImage($event.target)">
                            <small class="p-invalid" *ngIf="!community.urlImage && isSubmit">
                                Ảnh đại diện không được để trống!
                            </small>
                            <label class="custom-file-label">{{fileTitle}}</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Tên dịch vụ</label>
                        <span class="text-danger">*</span>
                        <input
                            [(ngModel)]="community.serviceName"
                            type="text" 
                            class="form-control" 
                            placeholder="Tên dịch vụ">
                        <small class="p-invalid" *ngIf="!community.serviceName && isSubmit">
                            Tên dịch vụ không được để trống!
                        </small>
                    </div>
                    <div class="form-group">
                        <label>Mô tả dịch vụ</label>
                        <span class="text-danger">*</span>
                        <br>
                        <textarea [(ngModel)]="community.description" class="textarea-style">
                        </textarea>
                        <small class="p-invalid" *ngIf="!community.description && isSubmit">
                            Mô tả không được để trống!
                        </small>
                    </div>
                    <div class="form-group">
                        <label>Giá tiền/ thời gian</label>
                        <span class="text-danger">*</span>
                        <input
                            [(ngModel)]="community.servicePrice"
                            type="text" 
                            class="form-control" 
                            placeholder="Giá tiền/ giờ">
                        <small class="p-invalid" *ngIf="!community.servicePrice && isSubmit">
                            Giá tiền không được để trống!
                        </small>
                    </div>
                </div>
            </div>
            
        </div>
        <div class="modal-footer">
            <button type="button" class="btn bg-light" (click)="submitCommunity()">Thêm</button>
            </div>
    </ng-template>
    <!-- popup notification -->
    <ng-template #notiModal let-modal>
        <div class="modal-header">
        <h4 class="modal-title">Thông báo</h4>
        <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
            <span aria-hidden="true">&times;</span>
        </button>
        </div>
        <div class="modal-body">
            <div *ngFor="let noti of bookingNotis" class="row">
                <div class="card-body">
                    <div class="alert alert-info" role="alert">
                        <p>Lượt đặt dịch vụ {{noti.serviceName}}
                            của khách hàng {{noti.fullName}} 
                            vào lúc {{noti.creationTime | date:'short'}}
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </ng-template>
    <!-- table -->
    <section>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-striped table-bordered">
                    <thead class="bg-light">
                    <tr>
                        <!-- <th>{{ "Mã dịch vụ" }}</th> -->
                        <th style="text-align: center;">{{ "Ảnh nền" }}</th>
                        <th>{{ "Tên dịch vụ" }}</th>
                        <th>{{ "Mô tả" }}</th>
                        <th>{{ "Giá tiền/giờ" }}</th>
                        <th style="width:10rem">{{ "Công cụ" }}</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr
                        *ngFor="let community of communities">
                        <!-- <td>{{community.communityId}}</td> -->
                        <td style="text-align: center;">
                            <img 
                                style="width: 50px; height: 50px;" 
                                [src]="community.urlImage" alt="">
                        </td>
                        <td>{{community.serviceName}}</td>
                        <td>{{community.description | mediumDescription}}</td>
                        <td>{{community.servicePrice | currency:'VND'}}</td>
                        <td style="width:10rem" class="d-flex justify-content-around">
                            <button
                                (click)="editCommunity(community)"
                                type="button"
                                class="btn btn-sm bg-warning">
                                <i class="fas fa-pencil-alt"></i>
                            </button>
                            <button
                                (click)="approveBooking(community)"
                                type="button"
                                class="btn btn-sm bg-light">
                                <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <p-toast position="bottom-right"></p-toast>
        </div>
    </section>
</div>